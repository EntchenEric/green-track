<mvc:View 
    controllerName="greentrack.controller.App"
    displayBlock="true"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:tnt="sap.tnt"
    xmlns:l="sap.ui.layout"
    xmlns="sap.m">

    <tnt:ToolPage id="toolPage">

        <tnt:header>
            <tnt:ToolHeader>
                <Button icon="sap-icon://menu2" type="Transparent" press="onSideNavButtonPress" tooltip="Menu"/>
                <Image src="assets/SAP_R_grad.svg" height="24px" densityAware="false" class="sapUiSmallMarginBegin" />
                <Title level="H1" text="GreenTrack" wrapping="false" class="sapUiTinyMarginBegin">
                    <layoutData>
                        <OverflowToolbarLayoutData priority="Disappear"/>
                    </layoutData>
                </Title>
                <ToolbarSpacer />
                <Button icon="sap-icon://search" type="Transparent" tooltip="Suche" />
                <Button icon="sap-icon://bell" type="Transparent" tooltip="Benachrichtigungen" press="onNotificationPress" id="notificationButton">
                    <customData>
                        <BadgeCustomData key="badge" value="2" visible="true"/>
                    </customData>
                </Button>
                <Avatar initials="GT" displaySize="XS" press="onUserPress" backgroundColor="Accent6" class="sapUiTinyMarginEnd"/>
            </tnt:ToolHeader>
        </tnt:header>

        <tnt:sideContent>
            <tnt:SideNavigation id="sideNavigation" selectedKey="home">
                <tnt:NavigationList>
                    <tnt:NavigationListItem icon="sap-icon://home" text="Home" key="home" press=".onNavToHome"/>
                    <tnt:NavigationListItem icon="sap-icon://bbyd-dashboard" text="Dashboard" key="dashboard" press=".onNavToDashboard"/>
                    
                    <tnt:NavigationListItem text="Logistik" icon="sap-icon://shipping-status" expanded="true">
                        <tnt:NavigationListItem text="Fahrzeuge" key="vehicles" press=".onNavToFahrzeuge" />
                        <tnt:NavigationListItem text="Routenoptimierung" key="routes" press=".onNavToRoutenoptimierung"/>
                    </tnt:NavigationListItem>

                    <tnt:NavigationListItem text="Verwaltung" icon="sap-icon://building">
                        <tnt:NavigationListItem text="Kontakte" key="contacts" press=".onNavToKontakte" />
                    </tnt:NavigationListItem>
                </tnt:NavigationList>
            </tnt:SideNavigation>
        </tnt:sideContent>

        <tnt:mainContents>
            <App id="app">
                <Page showHeader="false" backgroundDesign="List">
                    <content>
                        
                        <VBox class="sapUiSmallMargin">
                            <Title text="Willkommen zurück, Logistik-Team!" titleStyle="H2" class="sapUiTinyMarginBottom"/>
                            <Text text="Hier ist der aktuelle Status Ihrer nachhaltigen Lieferkette." class="sapUiSmallMarginBottom" />
                            
                            <l:Grid defaultSpan="XL3 L4 M6 S12" class="sapUiSmallMarginTop">
                                <GenericTile class="sapUiTinyMarginBegin sapUiTinyMarginTop" header="CO2 Einsparung" subheader="Diesen Monat" press="onPressTile">
                                    <TileContent unit="kg" footer="Ziel erreicht">
                                        <NumericContent value="450" icon="sap-icon://energy-saving-lightbulb" valueColor="Good" withMargin="false" />
                                    </TileContent>
                                </GenericTile>

                                <GenericTile class="sapUiTinyMarginBegin sapUiTinyMarginTop" header="Aktive Fahrzeuge" subheader="Auf der Straße" press="onPressTile">
                                    <TileContent footer="Alle Systeme normal">
                                        <NumericContent value="12" icon="sap-icon://shipping-status" valueColor="Neutral" withMargin="false" />
                                    </TileContent>
                                </GenericTile>

                                <GenericTile class="sapUiTinyMarginBegin sapUiTinyMarginTop" header="Routen Effizienz" subheader="Optimierungspotenzial" press="onPressTile">
                                    <TileContent unit="%" footer="Handlungsbedarf">
                                        <NumericContent value="88" icon="sap-icon://performance" valueColor="Critical" withMargin="false" />
                                    </TileContent>
                                </GenericTile>
                            </l:Grid>
                        </VBox>

                        <Panel headerText="Aktuelle Warnmeldungen &amp; Status" class="sapUiSmallMargin" expandable="false">
                            <Table id="alertsTable" growing="true" growingThreshold="5" inset="false">
                                <columns>
                                    <Column><Text text="Fahrzeug ID" /></Column>
                                    <Column minScreenWidth="Tablet" demandPopin="true"><Text text="Status" /></Column>
                                    <Column minScreenWidth="Desktop" demandPopin="true"><Text text="Standort" /></Column>
                                    <Column hAlign="End"><Text text="Priorität" /></Column>
                                </columns>
                                <items>
                                    <ColumnListItem>
                                        <cells>
                                            <ObjectIdentifier title="LKW-004" text="E-Transporter"/>
                                            <ObjectStatus text="Verspätet" state="Error" />
                                            <Text text="Berlin, A10" />
                                            <ObjectStatus text="Hoch" state="Warning" icon="sap-icon://alert" />
                                        </cells>
                                    </ColumnListItem>
                                    <ColumnListItem>
                                        <cells>
                                            <ObjectIdentifier title="LKW-012" text="Diesel Hybrid"/>
                                            <ObjectStatus text="Unterwegs" state="Success" />
                                            <Text text="München, B471" />
                                            <ObjectStatus text="Normal" state="Success" />
                                        </cells>
                                    </ColumnListItem>
                                     <ColumnListItem>
                                        <cells>
                                            <ObjectIdentifier title="LKW-009" text="E-Transporter"/>
                                            <ObjectStatus text="Laden" state="Information" />
                                            <Text text="Depot Nord" />
                                            <ObjectStatus text="Niedrig" state="None" />
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </Panel>

                        <!-- Popover for Notifications -->
                        <Popover id="notificationPopover" title="Orders" placement="Bottom" style="max-width: 300px;">
                            <VBox>
                                <NotificationList>
                                    <layoutData>
                                        <FlexItemData maxWidth="300px" />
                                    </layoutData>
                                    <NotificationListGroup
                                        title="Orders"
                                        showCloseButton="true"
                                        close=".onItemClose">
                                        <buttons>
                                            <Button text="Accept All" press=".onAcceptPress" />
                                        </buttons>

                                       <NotificationListItem
                                            title="Neue Bestellung (#2525)"
                                            description="Eine neue Transportbestellung wurde erstellt. Bitte prüfen Sie die Details und bestätigen Sie die Route oder weisen Sie einem Fahrer zu."
                                            showCloseButton="true"
                                            datetime="vor 1 Stunde"
                                            unread="true"
                                            priority="None"
                                            close=".onItemClose"
                                            press=".onListItemPress"
                                            authorPicture="sap-icon://car-rental"
                                            authorAvatarColor="Accent8" />

                                        <NotificationListItem
                                            title="Neue Bestellung (#2524)"
                                            description="Ein Kunde hat eine neue Bestellung aufgegeben. Überprüfen Sie die Lieferadresse und weisen Sie das passende Fahrzeug zu."
                                            showCloseButton="true"
                                            datetime="vor 3 Tagen"
                                            unread="true"
                                            priority="High"
                                            close=".onItemClose"
                                            press=".onListItemPress"
                                            authorInitials="SF"
                                            authorAvatarColor="Random">
                                            <buttons>
                                                <Button text="Akzeptieren" press=".onAcceptPress" />
                                                <Button text="Ablehnen" press=".onRejectPress" />
                                            </buttons>
                                        </NotificationListItem>

                                        <NotificationListItem
                                            title="Neue Bestellung (#2523)"
                                            description="Die Lieferung wurde erfolgreich abgeschlossen. Bitte bestätigen Sie den Abschluss oder geben Sie Feedback."
                                            showCloseButton="false"
                                            unread="false"
                                            datetime="vor 3 Tagen"
                                            priority="High"
                                            close=".onItemClose"
                                            press=".onListItemPress"
                                            authorInitials="YR"
                                            authorAvatarColor="Accent7">
                                            <buttons>
                                                <Button text="Akzeptieren" press=".onAcceptPress" />
                                                <Button text="Ablehnen" press=".onRejectPress" />
                                            </buttons>
                                        </NotificationListItem>

                            </VBox>
                        </Popover>

                    </content>
                </Page>
            </App>
        </tnt:mainContents>
    </tnt:ToolPage>
</mvc:View>